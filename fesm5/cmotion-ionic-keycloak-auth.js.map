{"version":3,"file":"cmotion-ionic-keycloak-auth.js","sources":["@cmotion/ionic-keycloak-auth/lib/contant/deep-linking-config-injection-token.ts","@cmotion/ionic-keycloak-auth/lib/contant/jwt-injection-token.ts","@cmotion/ionic-keycloak-auth/lib/contant/kc-injection-token.ts","@cmotion/ionic-keycloak-auth/lib/model/auth-token.ts","@cmotion/ionic-keycloak-auth/lib/model/deep-link-config.ts","@cmotion/ionic-keycloak-auth/lib/model/id-token-decoded.ts","@cmotion/ionic-keycloak-auth/lib/model/jwt-config.ts","@cmotion/ionic-keycloak-auth/lib/model/kc-config.ts","@cmotion/ionic-keycloak-auth/lib/model/key-value-str.ts","@cmotion/ionic-keycloak-auth/lib/model/keycloak-json-structure.ts","@cmotion/ionic-keycloak-auth/lib/model/keycloak-login-response.ts","@cmotion/ionic-keycloak-auth/lib/model/module-config.ts","@cmotion/ionic-keycloak-auth/lib/model/token-decoded.ts","@cmotion/ionic-keycloak-auth/lib/service/deep-link.service.ts","@cmotion/ionic-keycloak-auth/lib/service/storage.service.ts","@cmotion/ionic-keycloak-auth/lib/service/keycloak-auth.service.ts","@cmotion/ionic-keycloak-auth/lib/service/kc-token-interceptor.service.ts","@cmotion/ionic-keycloak-auth/lib/ionic-keycloak-auth.module.ts"],"names":["tslib_1.__extends"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {InjectionToken} from '@angular/core';\n\nexport const DEEP_LINKING_OPTIONS = new InjectionToken('DEEP_LINKING_OPTIONS');\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {InjectionToken} from '@angular/core';\n\nexport const JWT_GET_AND_SETTER = new InjectionToken('JWT_GET_AND_SETTER');\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {InjectionToken} from '@angular/core';\n\nexport const KEYCLOAK_OPTIONS = new InjectionToken('KEYCLOAK_OPTIONS');\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport interface AuthToken {\n  access_token: string;\n  expires_in: number;\n  id_token: string;\n  'not-before-policy': number;\n  refresh_expires_in: number;\n  refresh_token: string;\n  scope: string;\n  session_state: string;\n  token_type: string;\n\n  [key: string]: any;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport class DeepLinkConfig {\n  deepLinkingScheme: string;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport interface IDTokenDecoded {\n  jti: string;\n  exp: number;\n  nbf: number;\n  iat: number;\n  iss: string;\n  aud: string;\n  sub: string;\n  typ: string;\n  azp: string;\n  nonce: string;\n  auth_time: number;\n  session_state: string;\n  acr: string;\n  email_verified: boolean;\n  name: string;\n  preferred_username: string;\n  given_name: string;\n  family_name: string;\n  email: string;\n  avatarUrl: string;\n  mobileNumber: string;\n  description: string;\n\n  [key: string]: any;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {AuthToken} from './auth-token';\n\nexport interface JwtConfig {\n  setToken: (value: AuthToken) => void | Promise<void | null>;\n  getToken: () => AuthToken | null | Promise<AuthToken | null>;\n\n  headerName?: string;\n  authScheme?: string;\n  whitelistedDomains?: Array<string | RegExp>;\n  blacklistedRoutes?: Array<string | RegExp>;\n  throwNoTokenError?: boolean;\n  skipWhenExpired?: boolean;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {KeycloakJsonStructure} from './keycloak-json-structure';\n\nexport declare type FetchKeycloakJSON = () => KeycloakJsonStructure | Promise<KeycloakJsonStructure>;\n\nexport class KcConfig {\n  /**\n   * The same as the contain of the keycloak.json\n   * Example: jsonConfig: () => require('/path/to/keycloak.json')\n   */\n  jsonConfig?: FetchKeycloakJSON;\n\n  /**\n   * Example: scope='openid email offline_access address profile', the value would be\n   * 'openid email offline_access address profile' here\n   */\n  scope?: string;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport interface KeyValueStr {\n    [key: string]: string;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport interface KeycloakJsonStructure {\n  realm?: string;\n  'auth-server-url'?: string;\n  'ssl-required'?: string;\n  resource?: string;\n  clientId?: string;\n  url?: string;\n  credentials?: null | {\n    secret: string\n  };\n  'confidential-port'?: number;\n\n  [key: string]: any;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nexport interface KeycloakLoginResponse {\n    code: string;\n    redirectUri: string;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {Provider} from '@angular/core';\nimport {KcConfig} from './kc-config';\nimport {DeepLinkConfig} from './deep-link-config';\nimport {JwtConfig} from './jwt-config';\n\nexport class ModuleConfig {\n  kcOptionsProvider?: Provider;\n  jwtConfigProvider?: Provider;\n\n  keycloakConfig?: KcConfig;\n  deepLinksConfig: DeepLinkConfig;\n  jwtModuleOptions?: JwtConfig;\n}\n","export interface TokenDecoded {\n    jti: string;\n    exp: number;\n    nbf: number;\n    iat: number;\n    iss: string;\n    aud: string;\n    sub: string;\n    typ: string;\n    azp: string;\n    nonce: string;\n    auth_time: number;\n    session_state: string;\n    acr: string;\n    'allowed-origins': string[];\n    realm_access: RealmAccess;\n    resource_access: ResourceAccess;\n    scope: string;\n    email_verified: boolean;\n    name: string;\n    preferred_username: string;\n    given_name: string;\n    family_name: string;\n    email: string;\n}\n\nexport interface RealmAccess {\n    roles: string[];\n}\n\nexport interface ResourceAccess {\n    account: RealmAccess;\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {Injectable} from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {filter} from 'rxjs/operators';\nimport {DeeplinkMatch, Deeplinks} from '@ionic-native/deeplinks/ngx';\nimport {NavController} from '@ionic/angular';\nimport {KeyValueStr} from '../model/key-value-str';\n\n@Injectable()\nexport class DeepLinkService {\n\n  private paramsSubject = new Subject<string>();\n\n  constructor(private navController: NavController,\n              private deepLinks: Deeplinks) {\n  }\n\n  params() {\n    return this.paramsSubject\n      .pipe(filter(str => !!str));\n  }\n\n  init() {\n    this.deepLinks\n      .route({})\n      .subscribe(\n        (match: DeeplinkMatch) => {\n          // match.$route - the route we matched, which is the matched entry from the arguments to route()\n          // match.$args - the args passed in the link\n          // match.$link - the full link data\n          this.extractData(match.$link);\n        },\n        nomatch => {\n          // nomatch.$link - the full link data\n          this.extractData(nomatch.$link);\n        }\n      );\n  }\n\n  private extractData($link) {\n    if ($link) {\n      const {path, fragment, host, scheme, url} = $link;\n      if (this.containsCode(fragment)) {\n        const extractCode = this.extractCode(fragment);\n        this.nextParams(extractCode.code);\n      }\n    }\n  }\n\n  private extractCode(url: string) {\n    const hashes = url.slice(url.indexOf('?') + 1).split('&');\n    const paramsObj = hashes.reduce((params, hash) => {\n      const [key, val] = hash.split('=');\n      return Object.assign(params, {[key]: decodeURIComponent(val)});\n    }, {} as KeyValueStr);\n    if ((!paramsObj) || (!paramsObj.code)) {\n      return;\n    }\n    paramsObj.code = (paramsObj.code as string).split('#')[0];\n    return paramsObj;\n  }\n\n  private nextParams(code: string) {\n    this.paramsSubject.next(code);\n  }\n\n  private containsCode(fragment: string) {\n    if (!fragment) {\n      return false;\n    }\n    return fragment.indexOf('code') > -1;\n  }\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {Inject, Injectable} from '@angular/core';\nimport {JwtConfig} from '../model/jwt-config';\nimport {AuthToken} from '../model/auth-token';\nimport {JWT_GET_AND_SETTER} from '../contant/jwt-injection-token';\n\n@Injectable()\nexport class StorageService {\n\n  constructor(\n    @Inject(JWT_GET_AND_SETTER) private config: JwtConfig,\n  ) {\n  }\n\n  public async setToken(value: AuthToken): Promise<void> {\n    return this.config.setToken(value);\n  }\n\n  public async getToken(): Promise<AuthToken> {\n    return this.config.getToken();\n  }\n\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {Inject, Injectable} from '@angular/core';\nimport {HttpClient, HttpHeaders, HttpParams} from '@angular/common/http';\nimport {DeepLinkService} from './deep-link.service';\nimport {StorageService} from './storage.service';\nimport {BrowserTab} from '@ionic-native/browser-tab/ngx';\nimport {JwtHelperService} from '@auth0/angular-jwt';\nimport {BehaviorSubject, Observable} from 'rxjs';\nimport * as Keycloak_ from 'keycloak-js';\nimport {KeycloakLoginOptions} from 'keycloak-js';\nimport {InAppBrowser} from '@ionic-native/in-app-browser/ngx';\nimport {Router} from '@angular/router';\nimport {IDTokenDecoded} from '../model/id-token-decoded';\nimport {FetchKeycloakJSON, KcConfig} from '../model/kc-config';\nimport {KeycloakJsonStructure} from '../model/keycloak-json-structure';\nimport {DeepLinkConfig} from '../model/deep-link-config';\nimport {AuthToken} from '../model/auth-token';\nimport {TokenDecoded} from '../model/token-decoded';\nimport {KeycloakLoginResponse} from '../model/keycloak-login-response';\nimport {KEYCLOAK_OPTIONS} from '../contant/kc-injection-token';\nimport {DEEP_LINKING_OPTIONS} from '../contant/deep-linking-config-injection-token';\n\n// Workaround from https://github.com/ng-packagr/ng-packagr/issues/343#issuecomment-350965445\nconst Keycloak = Keycloak_;\nconst jwtHelperService: JwtHelperService = new JwtHelperService();\n\n@Injectable()\nexport class KeycloakAuthService {\n\n  private subject: BehaviorSubject<IDTokenDecoded>;\n  private scope: string;\n  private readonly appPrefix: string;\n  private readonly keycloakConfig: FetchKeycloakJSON;\n  private actualKeycloakConfig: KeycloakJsonStructure;\n  private keycloakInstance: Keycloak_.KeycloakInstance;\n\n  constructor(\n    @Inject(DEEP_LINKING_OPTIONS) deepLinkConfig: DeepLinkConfig,\n    @Inject(KEYCLOAK_OPTIONS) kcConfig: KcConfig,\n    protected http: HttpClient,\n    protected browserTab: BrowserTab,\n    protected router: Router,\n    protected storage: StorageService,\n    protected inAppBrowser: InAppBrowser,\n    protected deepLinkService: DeepLinkService,\n  ) {\n    this.scope = kcConfig.scope;\n    this.keycloakConfig = kcConfig.jsonConfig;\n    this.appPrefix = `${deepLinkConfig.deepLinkingScheme}://app`;\n  }\n\n  /**\n   *\n   */\n  public user(): Observable<IDTokenDecoded> {\n    if (!this.subject) {\n      this.subject = new BehaviorSubject<IDTokenDecoded>(null);\n    }\n    return this.subject.asObservable();\n  }\n\n  /**\n   *\n   */\n  public async init() {\n    await this.initKeycloak();\n    return this.refresh();\n  }\n\n  /**\n   *\n   */\n  public async logout() {\n    await this.handleNewToken(null);\n    const url: string = this.getLogoutUrl();\n    return new Promise<void>(async (resolve, reject) => {\n      if (await this.browserTab.isAvailable()) {\n        this.browserTab.openUrl(url)\n          .then(() => this.browserTab.close())\n          .catch(err => reject(err));\n        resolve();\n      } else {\n        const browser = this.inAppBrowser.create(url, '_system');\n        const sub = browser.on('loadstop')\n          .subscribe(() => {\n            browser.close();\n            resolve();\n            sub.unsubscribe();\n          }, err => {\n            reject(err);\n            sub.unsubscribe();\n          });\n      }\n    });\n  }\n\n  /**\n   *\n   * @param isLogin\n   * @param redirectUrl\n   */\n  public async login(isLogin: boolean = true, redirectUrl?: string): Promise<AuthToken> {\n    try {\n      if (redirectUrl[0] === '/') {\n        redirectUrl = redirectUrl.substr(1);\n      }\n      const response = await this.beginLoginAndGetCode(redirectUrl, isLogin);\n      return this.continueLoginWithCode(response);\n    } catch (err) {\n      const context = {messageError: 'Ionic Keycloak Error: error by login'};\n      Object.assign(err, {context});\n      throw err;\n    }\n  }\n\n\n  /**\n   *\n   * @param refresh\n   */\n  public async getToken(refresh = false) {\n    let authToken = await this.storage.getToken();\n    if (!authToken) {\n      return null;\n    }\n    if (refresh || jwtHelperService.isTokenExpired(authToken.access_token, 10)) {\n      authToken = await this.refresh();\n    }\n    return authToken.access_token;\n  }\n\n  public async getTokenDecoded(refresh = false): Promise<TokenDecoded> {\n    const token = await this.getToken(refresh);\n    return jwtHelperService.decodeToken(token) as TokenDecoded;\n  }\n\n  private getLogoutUrl(redirectUrl = this.router.url): string {\n    return this.keycloakInstance.createLogoutUrl({\n      redirectUri: this.appPrefix + encodeURIComponent(redirectUrl)\n    });\n  }\n\n  private async getKcJsonStructure(): Promise<KeycloakJsonStructure> {\n    const prom = this.keycloakConfig();\n    let config: KeycloakJsonStructure;\n    if (prom instanceof Promise) {\n      config = await prom;\n    } else {\n      config = prom;\n    }\n    /**\n     * This line because the init method needs the clientId and url to work\n     * which are the resource and the auth-server-url respectively\n     */\n    config.clientId = config.resource;\n    config.url = config['auth-server-url'];\n    return config;\n  }\n\n  private async handleNewToken(authToken: AuthToken) {\n    if (authToken) {\n      const user: IDTokenDecoded = jwtHelperService.decodeToken(authToken.id_token || authToken.access_token);\n      if (!this.subject) {\n        this.subject = new BehaviorSubject<IDTokenDecoded>(user);\n      }\n      this.subject.next(user);\n      await this.storage.setToken(authToken);\n    } else {\n      if (!this.subject) {\n        this.subject = new BehaviorSubject<IDTokenDecoded>(null);\n      }\n      this.subject.next(null);\n      await this.storage.setToken(null);\n    }\n  }\n\n  private createPostRequest(uri: string, body: any, options?: {\n    headers?: HttpHeaders | {\n      [header: string]: string | string[];\n    };\n  }) {\n    return this.http.post<AuthToken>(uri, body, options).toPromise();\n  }\n\n  private getRefreshParams(refreshToken: string) {\n    const params = new HttpParams()\n      .set('grant_type', 'refresh_token')\n      .set('refresh_token', refreshToken)\n      .set('client_id', encodeURIComponent(this.keycloakInstance.clientId));\n    const secret = this.keycloakInstance.clientSecret;\n    if (secret) {\n      return params\n        .set('client_secret', encodeURIComponent(secret));\n    }\n    return params;\n  }\n\n  private getAccessTokenParams(code: string, redirectUrl: string) {\n    let redirectUri = new HttpParams()\n      .set('grant_type', 'authorization_code')\n      .set('code', code)\n      .set('client_id', encodeURIComponent(this.keycloakInstance.clientId))\n      .set('redirect_uri', redirectUrl);\n    if (this.scope || (this.actualKeycloakConfig && this.actualKeycloakConfig.scope)) {\n      redirectUri = redirectUri.set('scope', this.scope || this.actualKeycloakConfig.scope);\n    }\n\n    const secret = this.keycloakInstance.clientSecret;\n    if (secret) {\n      redirectUri = redirectUri.set('client_secret', encodeURIComponent(secret));\n    }\n    return redirectUri;\n  }\n\n  private getTokenRequestHeaders() {\n    const headers = new HttpHeaders()\n      .set('Content-Type', 'application/x-www-form-urlencoded');\n\n    const clientSecret = this.keycloakInstance.clientSecret;\n    const clientId = this.keycloakInstance.clientId;\n    if (clientId && clientSecret) {\n      headers.set('Authorization', 'Basic ' + btoa(clientId + ':' + clientSecret));\n    }\n    return headers;\n  }\n\n  private async refresh(): Promise<AuthToken> {\n    try {\n      let tokens: AuthToken = await this.storage.getToken();\n      if (tokens) {\n        if (!this.isValidToken(tokens)) {\n          const uri = this.getTokenUrl();\n          const headers = this.getTokenRequestHeaders();\n          const body = this.getRefreshParams(tokens.refresh_token);\n          tokens = await this.createPostRequest(uri, body, {headers});\n        }\n      }\n      this.handleNewToken(tokens);\n      return tokens;\n    } catch (e) {\n      await this.logout();\n      return null;\n    }\n  }\n\n  private getTokenUrl() {\n    return `${this.keycloakInstance.authServerUrl}/realms/${this.keycloakInstance.realm}/protocol/openid-connect/token`;\n  }\n\n  private isValidToken(authToken: AuthToken) {\n    if (!authToken) {\n      return false;\n    }\n    return jwtHelperService.isTokenExpired(authToken.access_token, 10);\n  }\n\n  private async initKeycloakInstance() {\n    const keycloakConfig = await this.getKcJsonStructure();\n    this.actualKeycloakConfig = keycloakConfig;\n    this.keycloakInstance = Keycloak(keycloakConfig);\n  }\n\n  private async initKeycloak() {\n    await this.initKeycloakInstance();\n\n    this.keycloakInstance\n      .init({\n        adapter: 'cordova-native',\n        redirectUri: this.appPrefix + '/'\n      });\n  }\n\n  private async beginLoginAndGetCode(path: string, login = true): Promise<KeycloakLoginResponse> {\n    path = `${this.appPrefix}/${path}`;\n    await this.storage.setToken(null);\n\n    const options: KeycloakLoginOptions = {\n      redirectUri: path\n    };\n    const url: string = login\n      ? this.keycloakInstance.createLoginUrl(options)\n      : this.keycloakInstance.createRegisterUrl(options);\n\n    if (await this.browserTab.isAvailable()) {\n      this.browserTab.openUrl(url);\n    } else {\n      this.inAppBrowser.create(url, '_system');\n    }\n\n    return new Promise<KeycloakLoginResponse>((resolve, reject) => {\n      const sub = this.deepLinkService\n        .params()\n        .subscribe(code => {\n          resolve({code, redirectUri: path});\n          sub.unsubscribe();\n        }, error => {\n          reject(error);\n          sub.unsubscribe();\n        });\n    });\n  }\n\n  private async continueLoginWithCode({code, redirectUri: redirectUrl}: KeycloakLoginResponse): Promise<AuthToken> {\n    this.browserTab.close()\n      .catch((err = {}) => {\n        const context = {message: 'Error while closing the browser'};\n        console.log(context.message, err);\n        Object.assign(err, {context});\n        throw err;\n      });\n    const uri = this.getTokenUrl();\n    const body = this.getAccessTokenParams(code, redirectUrl);\n    const headers = this.getTokenRequestHeaders();\n    return this.createPostRequest(uri, body, {headers})\n      .then(async authToken => {\n        this.handleNewToken(authToken);\n        return authToken;\n      });\n  }\n\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {Inject, Injectable} from '@angular/core';\nimport {JwtHelperService, JwtInterceptor} from '@auth0/angular-jwt';\nimport {KeycloakAuthService} from './keycloak-auth.service';\nimport {JwtConfig} from '../model/jwt-config';\nimport {JWT_GET_AND_SETTER} from '../contant/jwt-injection-token';\n\n@Injectable()\nexport class KcTokenInterceptorService extends JwtInterceptor {\n\n  constructor(\n    @Inject(JWT_GET_AND_SETTER) private config: JwtConfig,\n    private keycloakAuthService: KeycloakAuthService\n  ) {\n    super(config, new JwtHelperService());\n    this.initTokenGetter();\n  }\n\n  private initTokenGetter() {\n    this.tokenGetter = () => this.keycloakAuthService.getToken();\n  }\n\n}\n","/*\n * Copyright (c) 2019. This Code is under license and belongs to Coding Motion\n */\n\nimport {ModuleWithProviders, NgModule, Optional, SkipSelf} from '@angular/core';\nimport {Platform} from '@ionic/angular';\nimport {NativeStorage} from '@ionic-native/native-storage/ngx';\nimport {BrowserTab} from '@ionic-native/browser-tab/ngx';\nimport {JwtHelperService} from '@auth0/angular-jwt';\nimport {HTTP_INTERCEPTORS, HttpClientModule} from '@angular/common/http';\nimport {Deeplinks} from '@ionic-native/deeplinks/ngx';\nimport {InAppBrowser} from '@ionic-native/in-app-browser/ngx';\nimport {DeepLinkService} from './service/deep-link.service';\nimport {KeycloakAuthService} from './service/keycloak-auth.service';\nimport {StorageService} from './service/storage.service';\nimport {KcTokenInterceptorService} from './service/kc-token-interceptor.service';\nimport {ModuleConfig} from './model/module-config';\nimport {JWT_GET_AND_SETTER} from './contant/jwt-injection-token';\nimport {KEYCLOAK_OPTIONS} from './contant/kc-injection-token';\nimport {DEEP_LINKING_OPTIONS} from './contant/deep-linking-config-injection-token';\n\n@NgModule()\nexport class IonicKeycloakAuthModule {\n\n  constructor(\n    private platform: Platform,\n    private authService: KeycloakAuthService,\n    private deepLinkService: DeepLinkService,\n    @Optional() @SkipSelf() parentModule: IonicKeycloakAuthModule\n  ) {\n    if (parentModule) {\n      throw new Error('JwtModule is already loaded. It should only be imported in your application\\'s main module.');\n    }\n    this.platform\n      .ready()\n      .then(() => this.authService.init())\n      .then(() => this.deepLinkService.init())\n      .catch((err = {}) => {\n        const context = {messageError: 'Ionic Keycloak Error: could not initialize the app'};\n        Object.assign(err, {context});\n        throw err;\n      });\n  }\n\n  public static forRoot(config = new ModuleConfig()): ModuleWithProviders {\n    return {\n      ngModule: IonicKeycloakAuthModule,\n      providers: [\n        Deeplinks,\n        BrowserTab,\n        InAppBrowser,\n        NativeStorage,\n        HttpClientModule,\n        config.kcOptionsProvider || {provide: KEYCLOAK_OPTIONS, useValue: config.keycloakConfig},\n        config.jwtConfigProvider || {provide: JWT_GET_AND_SETTER, useValue: config.jwtModuleOptions},\n        {provide: DEEP_LINKING_OPTIONS, useValue: config.deepLinksConfig},\n        StorageService,\n        DeepLinkService,\n        KeycloakAuthService,\n        JwtHelperService,\n        {\n          provide: HTTP_INTERCEPTORS,\n          useClass: KcTokenInterceptorService,\n          multi: true\n        },\n      ]\n    };\n  }\n\n}\n"]}